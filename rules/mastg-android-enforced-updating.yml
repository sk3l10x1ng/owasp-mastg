rules:
  - id: mastg-android-enforced-updating
    severity: WARNING
    languages:
      - java
    metadata:
      summary: This rule detects usage of Play Core's immediate in-app update enforcement
    message: "[MASVS-CODE-1] immediate in-app update enforcement detected."
    patterns:
      - pattern-either:
          - pattern: $OBJ.startUpdateFlowForResult($INFO, $LAUNCHER,
              AppUpdateOptions.newBuilder(1).build())